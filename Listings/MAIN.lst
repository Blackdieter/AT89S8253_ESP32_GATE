A51 MACRO ASSEMBLER  MAIN                                                                 11/07/2024 10:06:02 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN .\Objects\MAIN.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE MAIN.A SET(SMALL) DEBUG PRINT(.\Listings\MAIN.lst) OBJECT(.\Objects\MAI
                      N.obj) EP

LOC  OBJ            LINE     SOURCE

                       1     ;
                       2     ; Hien mot so
                       3     ; start
                       4     ;
                       5     
  0080                 6     data_7seg equ p0
  00A2                 7     led1 bit p2.2
  00A3                 8     led2 bit p2.3
  00B2                 9     button bit p3.2  ; Define button input
0000                  10     org 00h
0000                  11     main: 
0000 90002E           12         mov dptr,#ma7seg    ; Initialize DPTR with the address of ma7seg
0003 C2A3             13         clr led2            ; Disable 7seg no2
0005 E4               14         clr a
0006 93               15         movc a,@a+dptr
0007 F580             16         mov data_7seg,a     ; Display initial value (0)
0009 D2B2             17         setb button         ; Set button as input
000B 8000             18         sjmp loop           ; Jump to loop
                      19     
000D                  20     loop:
000D 30B202           21         jnb button,increment ; If button is pressed, jump to increment
0010 80FB             22         sjmp loop           ; Otherwise, keep looping
                      23     
0012                  24     increment:
0012 1121             25         call delay          ; Call delay subroutine
0014 A3               26         inc dptr            ; Increment DPTR to point to the next value
0015 E4               27         clr a
0016 93               28         movc a,@a+dptr
0017 F580             29         mov data_7seg,a     ; Display the next value
0019 B490F1           30         cjne a,#0x90,loop   ; If the value is not 0x90 (9), go back to loop
001C 90002E           31         mov dptr,#ma7seg    ; Reset DPTR to the start of ma7seg
001F 80EC             32         sjmp loop           ; Go back to loop
                      33     
0021                  34     delay:
0021 7F05             35         mov r7, #5         ; Outer loop count (20 * 50ms = 1 second) Fix this number to decrease
0023 7EFA             36     d1: mov r6, #250        ; Inner loop count
0025 7DFA             37     d2: mov r5, #250        ; Innermost loop count
0027 DDFE             38     d3: djnz r5, d3         ; Decrement R5 until it reaches 0
0029 DEFA             39         djnz r6, d2         ; Decrement R6 until it reaches 0
002B DFF6             40         djnz r7, d1         ; Decrement R7 until it reaches 0
002D 22               41         ret                 ; Return from subroutine
                      42     
002E                  43     ma7seg:
002E C0F9A4B0         44         db 0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8,0x80,0x90 
0032 999282F8                
0036 8090                    
                      45     end 
A51 MACRO ASSEMBLER  MAIN                                                                 11/07/2024 10:06:02 PAGE     2

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

BUTTON . . . . . .  B ADDR   00B0H.2 A   
D1 . . . . . . . .  C ADDR   0023H   A   
D2 . . . . . . . .  C ADDR   0025H   A   
D3 . . . . . . . .  C ADDR   0027H   A   
DATA_7SEG. . . . .  D ADDR   0080H   A   
DELAY. . . . . . .  C ADDR   0021H   A   
INCREMENT. . . . .  C ADDR   0012H   A   
LED1 . . . . . . .  B ADDR   00A0H.2 A   
LED2 . . . . . . .  B ADDR   00A0H.3 A   
LOOP . . . . . . .  C ADDR   000DH   A   
MA7SEG . . . . . .  C ADDR   002EH   A   
MAIN . . . . . . .  C ADDR   0000H   A   
P0 . . . . . . . .  D ADDR   0080H   A   
P2 . . . . . . . .  D ADDR   00A0H   A   
P3 . . . . . . . .  D ADDR   00B0H   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
